<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Model-View-Controller: An introduction to MVC architecture for web apps</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>MVC</h1>
					<h2>Model-View-Controller</h2>
					<p>An architectural pattern that splits applications into sections each of which have a unique purpose.</p>
				</section>
				<section>
					<h2>Overview</h2>
				</section>
				<section>
					<h3>Model</h3>
					<p>Models determine how data is structured in a database.</p>
					<h3>View</h3>
					<p>Views are what the user sees and can interact with</p>
					<h3>Controller</h3>
					<p>Controllers listen for requests, interact with the models, request appropriate views and respond with those views to the client.</p>
				</section>
				<section>
					<p>In web apps, we add some extra pieces.</p>
				</section>
				<section>
					<h3>Router</h3>
					<p>Routers listen for user requests and send them to the appropriate controller.</p>
					<h3>Database</h3>
					<p>The database stores data our models define.  They interact with the models.</p>
				</section>
				<section>
					<p>What does it all look like?</p>
				</section>
				<section>
					<img src="imgs/mvc.png" alt="Client --> Router --> Controller --> Models, Views --> Controller --> Client">
				</section>
				<section>
					<ol>
						<li>The user interacts with their browser to send a request to the server</li>
						<li>The router examines the request and directs it to the appropriate controller</li>
						<li>The controller handles the request.  Often this involves handing it off to a model. Suppose it's a PUT request, the controller waits for a promise to complete... </li>
					</ol>
				</section>
				<section>
					<ol>
						<li>The controller calls the model with the data in order to update the information</li>
						<li>The model may validate the information against a Schema to ensure correctness</li>
						<li>The model creates a request to the database to update the information</li>
						<li>The database responds to the model</li>
						<li>The model responds to the controller with any information or in the case of javascript a completed promise</li>
					</ol>
				</section>
				<section>
					<h4>...Then</h4>
					<ol start="4">
						<li>The controller continues its process, and assuming the request was successful to redirect the browser to the appropriate page, which 
							will cause a new GET request (see diagram). The GET is made, and the controller receives the data from the model for the GET, it selects a view to render for the GET request.</li>
						<li>The view is rendered</li>
						<li>The page the view generates is returned to the controller, which passes it back to the browser</li>
						<li>The user see the newly rendered page</li>
					</ol>
				</section>
				<section>
					<p>Taking the previous slides and combining them into the image before, we see</p>
				</section>
				<section>
					<img src="imgs/mvc_put.png" alt="Previous slides in graphical form">
				</section>
				<section>
					So what the heck is a schema?
				</section>
				<section>
					A schema is a structure given to the data stored in a database.  This creates consistency throughout a project and enables developers to know how data is stored.
				</section>
				<section>Since objects in JavaScript can have additional properties, using a schema means that documents or rows stored in a database are regular.</section>
				<section>No more worrying about entries without username, or some other field that ought to be there</section>
				<section>In MongoDB, the schema is a JSON object that allows developers to give shape and meta-properties to the documents being stored.</section>
				<section>We can define types, make particular fields mandatory, and even define object types if the field stores an object that needs to conform to a particular shape.</section>
				<section>
					So what does a schema actually look like?
				</section>
				<section>
					<pre><code data-trim data-noescape>
						const TodoSchema = new mongoose.Schema({
							todo: {
								type: String,
								required: true,
							},
							completed: {
								type: Boolean,
								required: true,
							},
							date: {
								type: Date, 
								required: false,
								min: new Date(),
							}
						})
					</code></pre>
				</section>
				<section>
					A mongoose you say?!?
				</section>
				<section>
					<p>Mongoose is a wrapper that makes working with mongoDB more straightforward 
					by provide Schema-based models for programs to work with.</p>
					<p>It provides the model component of the MVC in our MERN app.</p>
				</section>
				<section>
					<h3>What does an MVC implementation in MERN look like?</h3>
					<p>Inside the project Root</p>
				</section>
				<section>
					<dl>
						<dt>config</dt>
								<dl>
										<dt>.env</dt>
										<dt>database.js</dt>
								</dl>
						<dt>controllers</dt>
								<dl>
										<dt>home.js</dt>
										<dt>todos.js</dt>
								</dl>
						<dt>models</dt>
							<dl>
									<dt>Todo.js</dt>
							</dl>
						<dt>public</dt>
							<dl>
								<dt>js -> main.js</dt>
								<dt>css -> style.css</dt>
							</dl>
					</dl>
				</section>
				<section>
					<dl>
						<dt>routes</dt>
						<dl>
							<dt>home.js</dt>
							<dt>todos.js</dt>
						</dl>
						<dt>views</dt>
							<dl>
									<dt>index.ejs</dt>
									<dt>todos.ejs</dt>
							</dl>
							<dt>package-lock.json</dt>
							<dt>package.json</dt>
							<dt>server.js</dt>
					</dl>
				</section>
				<section>
					<p>The MVC architecture allows developers to quickly locate pertinent sections of code,
						swap out different implementations of components with minimal impact on other parts of the code.
					</p>
				</section>
				<section>
					<p>For example, suppose you want to use a relational database instead of a non-relational one.  
						Just change the implementation of the model to use the new relational database and everything else still works.
					</p>
				</section>
				<section>
					<p>MVC is scalable, speeds up development through coherent organization, and supports multiple methods of displaying or interacting with the app.  </p>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
